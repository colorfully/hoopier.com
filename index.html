<!DOCTYPE html>

<html>

<head>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<title>亲爱的嘉丽</title>

<meta name="viewport" content="initial-scale=1">

<link rel="stylesheet" href="css/swiper.min.css">

<script type="text/javascript" src="js/jquery-1.10.1.min.js"></script>

<script type="text/javascript" src="js/swiper.min.js"></script>


<style>

* {

	margin: 0;

	padding: 0;

}

  .swiper-container {

  

  }

  .swiper-wrapper {

    -webkit-perspective: 1200px;

    -moz-perspective: 1200px;

    -ms-perspective: 1200px;

    perspective: 1200px;

  }

  .swiper-slide {

    position: relative;

    -webkit-transform-style: preserve-3d;

    -moz-transform-style: preserve-3d;

    -ms-transform-style: preserve-3d;

    transform-style: preserve-3d;

   background-size:100% auto;

   overflow:hidden;

   text-align:center;

   line-height:300px;

  }

.swiper-slide img{

	max-width:100%;

}



</style>

</head>

<body>
 <audio id="bgmusic" autoplay preload loop controls></audio>
<audio  src="music.mp3" autoplay="autoplay" loop="loop" id="bgAudio"></audio>

<div style="max-width:640px; margin:0 auto;">

<div class="swiper-container">


  

</div>

</div>

<script type = "text/javascript">

function fixPagesHeight() {

	$('.swiper-slide,.swiper-container').css({

		height: $(window).height(),

	})

}

$(window).on('resize', function() {

	fixPagesHeight();

})

fixPagesHeight();





var mySwiper = new Swiper('.swiper-container', {



    direction: 'vertical',

	mousewheelControl: true,

	watchSlidesProgress: true,

	onInit: function(swiper) {

		swiper.myactive = 0;

		

	},

	onProgress: function(swiper) {

		for (var i = 0; i < swiper.slides.length; i++) {

			var slide = swiper.slides[i];

			var progress = slide.progress;

			var translate, boxShadow;



			translate = progress * swiper.height * 0.8;

			scale = 1 - Math.min(Math.abs(progress * 0.2), 1);

			boxShadowOpacity = 0;



			slide.style.boxShadow = '0px 0px 10px rgba(0,0,0,' + boxShadowOpacity + ')';



			if (i == swiper.myactive) {

				es = slide.style;

				es.webkitTransform = es.MsTransform = es.msTransform = es.MozTransform = es.OTransform = es.transform = 'translate3d(0,' + (translate) + 'px,0) scale(' + scale + ')';

				es.zIndex=0;





			}else{

				es = slide.style;

				es.webkitTransform = es.MsTransform = es.msTransform = es.MozTransform = es.OTransform = es.transform ='';

				es.zIndex=1;

				

			}



		}



	},





	onTransitionEnd: function(swiper, speed) {

		for (var i = 0; i < swiper.slides.length; i++) {

		//	es = swiper.slides[i].style;

		//	es.webkitTransform = es.MsTransform = es.msTransform = es.MozTransform = es.OTransform = es.transform = '';



		//	swiper.slides[i].style.zIndex = Math.abs(swiper.slides[i].progress);



			

		}



		swiper.myactive = swiper.activeIndex;



	},

	onSetTransition: function(swiper, speed) {



		for (var i = 0; i < swiper.slides.length; i++) {

			//if (i == swiper.myactive) {



				es = swiper.slides[i].style;

				es.webkitTransitionDuration = es.MsTransitionDuration = es.msTransitionDuration = es.MozTransitionDuration = es.OTransitionDuration = es.transitionDuration = speed + 'ms';

			//}

		}



	}



});

</script>
 <script>
    (function() {
        function log(info) {
            console.log(info);
            // alert(info);
        }
        function forceSafariPlayAudio() {
            audioEl.load(); // iOS 9   还需要额外的 load 一下, 否则直接 play 无效
            audioEl.play(); // iOS 7/8 仅需要 play 一下
        }

        var audioEl = document.getElementById('bgmusic');

        // 可以自动播放时正确的事件顺序是
        // loadstart
        // loadedmetadata
        // loadeddata
        // canplay
        // play
        // playing
        // 
        // 不能自动播放时触发的事件是
        // iPhone5  iOS 7.0.6 loadstart
        // iPhone6s iOS 9.1   loadstart -> loadedmetadata -> loadeddata -> canplay
        audioEl.addEventListener('loadstart', function() {
            log('loadstart');
        }, false);
        audioEl.addEventListener('loadeddata', function() {
            log('loadeddata');
        }, false);
        audioEl.addEventListener('loadedmetadata', function() {
            log('loadedmetadata');
        }, false);
        audioEl.addEventListener('canplay', function() {
            log('canplay');
        }, false);
        audioEl.addEventListener('play', function() {
            log('play');
            // 当 audio 能够播放后, 移除这个事件
            window.removeEventListener('touchstart', forceSafariPlayAudio, false);
        }, false);
        audioEl.addEventListener('playing', function() {
            log('playing');
        }, false);
        audioEl.addEventListener('pause', function() {
            log('pause');
        }, false);

        // 由于 iOS Safari 限制不允许 audio autoplay, 必须用户主动交互(例如 click)后才能播放 audio,
        // 因此我们通过一个用户交互事件来主动 play 一下 audio.
        window.addEventListener('touchstart', forceSafariPlayAudio, false);

        audioEl.src = 'music.mp3';
    })();
    </script>


</div>
</body>
</html>

